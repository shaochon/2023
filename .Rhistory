summary(mod)
plot(tc ~ age, data=dat,col='grey')
lines(dat$age,fitted(mod),col="red")
mod <- lm(tc ~  bmi+bSpline(age,knots = c(50),degree=2), data = dat)
mod <- lm(tc ~  bmi+bSpline(age,knots = c(50),degree=2), data = dat)
summary(mod)
summary(stepwise(tc ~ age + I(age^2) + bmi + female + I(age^2) * female + age * female + bSpline(age,knots = c(20,35,50),degree=3), data = dat))
summary(step_wise(tc ~ age + I(age^2) + bmi + female + I(age^2) * female + age * female + bSpline(age,knots = c(20,35,50),degree=3), data = dat))
summary(step(lm(tc ~ age + I(age^2) + bmi + female + I(age^2) * female + age * female + bSpline(age,knots = c(20,35,50),degree=3), data = dat)))
step(lm(tc ~ age + I(age^2) + bmi + female + I(age^2) * female + age * female + bSpline(age,knots = c(20,35,50),degree=3), data = dat))
step(lm(tc ~ age + I(age^2) + bmi + female + I(age^2) * female + age * female + bSpline(age,knots = c(20,35,50),degree=3), data = dat,direction='forward'))
step(lm(tc ~ age + I(age^2) + bmi + female + I(age^2) * female + age * female,degree=3), data = dat,direction='forward'))
model = lm(tc ~ age + I(age^2) + bmi + female + I(age^2) * female + age * female + bSpline(age,knots = c(20,35,50),degree=3))
model = lm(tc ~ age + I(age^2) + bmi + female + I(age^2) * female + age * female + bSpline(age,knots = c(20,35,50),degree=3),data=dat)
step(model,direction='forward')
step_model = step(model,direction='forward')
tidy(step_model)
library(tidyverse)
tidy(step_model)
library(tidyr)
tidy(step_model)
library(broom)
tidy(step_model)
model = lm(tc ~ 1,data=dat)
step_model = step(model,direction='forward',scope = (~age + I(age^2) + bmi + female + I(age^2) * female + age * female + bSpline(age,knots = c(20,35,50),degree=3)))
tidy(step_model)
step_model
step_model$model
AIC(step_model)
summary(lm(tc~I(age^2)+bSpline(age,df=4,degree=3),data=dat))
summary(lm(tc~bSpline(age,df=4,degree=3),data=dat))
summary(lm(tc~bSpline(age,knots = c(20),degree=1),data=dat))
summary(lm(tc~bSpline(age,knots = c(20),degree=1),data=dat))
#Part C
model_quad_spline=lm(tc~age+I(age^2)+bSpline(age,df=4,degree=3),data=dat)
summary(model_quad_spline)
#Part D
anova(model_quad,model_quad_spline)
summary(lm(tc~bmi+age,data=dat))
summary(lm(tc~bmi+age,data=dat))
#Part C
model_quad_spline=lm(tc~age+I(age^2)+bSpline(age,df=4,degree=3),data=dat)
summary(model_quad_spline)
#Part D
anova(model_quad,model_quad_spline)
set.seed(2023-10-1)
n <- 40
bdays <- sample(1:365, size = n, replace = TRUE)
## Hint: use the duplicated function
duplicated(bdays)
## Hint: use the duplicated function
sum(duplicated(bdays))
## Hint: use replicate and remember mean of logicals gives you the proportion of TRUE
n= 1000
duplicated(sample(1:365, size = n, replace = TRUE))
## Hint: use replicate and remember mean of logicals gives you the proportion of TRUE
n= 1000
sum(duplicated(sample(1:365, size = n, replace = TRUE)))/n
## Hint: use replicate and remember mean of logicals gives you the proportion of TRUE\
B = 1000
replicate(B,(any(sample(1:365, size = n, replace = TRUE))))
## Hint: use replicate and remember mean of logicals gives you the proportion of TRUE\
B = 1000
replicate(B,(any(sample(1:365, size = n, replace = TRUE)))) |> mean()
set.seed(2023-10-1)
n <- 25
bdays <- sample(1:365, size = n, replace = TRUE)
## Hint: use replicate and remember mean of logicals gives you the proportion of TRUE\
B = 1000
replicate(B,(any(sample(1:365, size = n, replace = TRUE)))) |> mean()
## Hint: use replicate and remember mean of logicals gives you the proportion of TRUE\
B = 1000
replicate(B,(any(sample(1:365, size = n, replace = TRUE)))) |> mean()
## Hint: use replicate and remember mean of logicals gives you the proportion of TRUE\
n = 25
B = 1000
replicate(B,(any(sample(1:365, size = n, replace = TRUE)))) |> mean()
## Hint: use replicate and remember mean of logicals gives you the proportion of TRUE\
n = 25
B = 1000
replicate(B,(any(suplicated(sample(1:365, size = n, replace = TRUE))))) |> mean()
## Hint: use replicate and remember mean of logicals gives you the proportion of TRUE\
n = 25
B = 1000
replicate(B,(any(duplicated(sample(1:365, size = n, replace = TRUE))))) |> mean()
## Hint: Use sapply.
sapply(1:50, function(n) replicate(B,(any(duplicated(sample(1:365, size = n, replace = TRUE))))) |> mean())
## Hint: Use sapply.
Pr <- function(n) replicate(B,(any(duplicated(sample(1:365, size = n, replace = TRUE))))) |> mean()
sapply(1:50,Pr(n))
## Hint: Use sapply.
Pr <- function(n) replicate(B,(any(duplicated(sample(1:365, size = n, replace = TRUE))))) |> mean()
sapply(1:50,Pr)
## Hint: Use sapply.
Pr <- function(n) replicate(B,(any(duplicated(sample(1:365, size = n, replace = TRUE))))) |> mean()
p <- sapply(1:50,Pr)
as.data.frame(n = 1:50,probability=p)
## Hint: Use sapply.
Pr <- function(n) replicate(B,(any(duplicated(sample(1:365, size = n, replace = TRUE))))) |> mean()
p <- sapply(1:50,Pr)
as.data.frame(n = c(1:50),probability=p)
## Hint: Use sapply.
Pr <- function(n) replicate(B,(any(duplicated(sample(1:365, size = n, replace = TRUE))))) |> mean()
p <- sapply(1:50,Pr)
plot(1:50,p)
## Hint: Use sapply.
Pr <- function(n) replicate(B,(any(duplicated(sample(1:365, size = n, replace = TRUE))))) |> mean()
p <- sapply(1:50,Pr)
plot(1:50,p)
## Hint: use the prod function to multiply a sequence of numbers.
epr <- function(n){
1 - prod(seq(364,365-n+1)/365)
}
## Hint: use the prod function to multiply a sequence of numbers.
epr <- function(n){
1 - prod(seq(364,365-n+1)/365)
}
sapply(1:50, epr)
## Hint: use the prod function to multiply a sequence of numbers.
epr <- function(n){
1 - prod(seq(364,365-n+1)/365)
}
line(1:50, sapply(1:50, epr),col='blue')
## Hint: use the prod function to multiply a sequence of numbers.
epr <- function(n){
1 - prod(seq(364,365-n+1)/365)
}
line(1:50, sapply(1:50, epr),color='blue')
## Hint: use the prod function to multiply a sequence of numbers.
epr <- function(n){
1 - prod(seq(364,365-n+1)/365)
}
line(1:50, sapply(1:50, epr),col='blue')
## Hint: Use sapply.
Pr <- function(n) replicate(B,(any(duplicated(sample(1:365, size = n, replace = TRUE))))) |> mean()
p <- sapply(1:50,Pr)
plot(1:50,p)
plot(1:50,p)
## Hint: use the prod function to multiply a sequence of numbers.
epr <- function(n){
1 - prod(seq(364,365-n+1)/365)
}
plot(1:50,p)
line(1:50, sapply(1:50, epr),col='blue')
## Hint: use the prod function to multiply a sequence of numbers.
epr <- function(n){
1 - prod(seq(364,365-n+1)/365)
}
plot(1:50,p)
lines(1:50, sapply(1:50, epr),col='blue')
## Hint: use the prod function to multiply a sequence of numbers.
epr <- function(n){
1 - prod(seq(364,365-n+1)/365)
}
plot(1:100,sapply(1:100,Pr) )
lines(1:100, sapply(1:100, epr),col='blue')
x <- sample(c(-1, 1), size = 1, prob = c(9/19, 10/19))
x
x <- sample(c(-1, 1), size = 1, prob = c(9/19, 10/19))
x
x <- sample(c(-1, 1), size = 1, prob = c(9/19, 10/19))
x
x <- sample(c(-1, 1), size = 1, prob = c(9/19, 10/19))
x
x <- sample(c(-1, 1), size = 1, prob = c(9/19, 10/19))
x
x <- sample(c(-1, 1), size = 1, prob = c(9/19, 10/19))
x
x <- sample(c(-1, 1), size = 1, prob = c(9/19, 10/19))
x
x <- sample(c(-1, 1), size = 1, prob = c(9/19, 10/19))
x
replicate(10, sample(c(-1, 1), size = 1, prob = c(9/19, 10/19)))
sample(c(-1, 1), size = 10, replace = TRUE, prob = c(9/19, 10/19))
x <- rbinom(10, 1, 10/19); x <- x*2 - 1
x <- rbinom(10, 1, 10/19); x <- x*2 - 1
x
x <- sample(c(-1, 1), size = 1000, replace = TRUE, prob = c(9/19, 10/19))
s <- sum(x)
x <- sample(c(-1, 1), size = 1000, replace = TRUE, prob = c(9/19, 10/19))
s <- sum(x)
s
x <- sample(c(-1, 1), size = 1000, replace = TRUE, prob = c(9/19, 10/19))
s <- sum(x)
s
x <- sample(c(-1, 1), size = 1000, replace = TRUE, prob = c(9/19, 10/19))
s <- sum(x)
s
x <- sample(c(-1, 1), size = 1000, replace = TRUE, prob = c(9/19, 10/19))
s <- sum(x)
s
x <- sample(c(-1, 1), size = 1000, replace = TRUE, prob = c(9/19, 10/19))
s <- sum(x)
s
x <- sample(c(-1, 1), size = 1000, replace = TRUE, prob = c(9/19, 10/19))
s <- sum(x)
s
s <- replicate(10^5,{
x <- sample(c(-1, 1), size = 1000, replace = TRUE, prob = c(9/19, 10/19))
sum(x)
})
plot(table(s))
mean(s < 0)
x <- sample(c(-1, 1), size = 10^6, replace = TRUE, prob = c(9/19, 10/19))
mean(x)
sqrt(mean((x - mean(x))^2))
n <- 1000
mu <- 1/19
sigma <- 2*sqrt(9/19*10/19)
pnorm(-mu*sqrt(n)/(sigma))
s <- replicate(10^3,{
x <- sample(c(0, 1), size = 5*10^5, replace = TRUE, prob = c(1 - 10^-6, 10^-6))
sum(x)
})
plot(table(s))
n <- (-sigma/mu*qnorm(0.01))^2
n <- (-sigma/mu*qnorm(0.01))^2
n
## Hint: copy and paste one of the previous Monte Carlo simulations and change n
s <- replicate(10^5,{
x <- sample(c(-1, 1), size = n, replace = TRUE, prob = c(9/19, 10/19))
sum(x)
})
plot(table(s))
## Hint: copy and paste one of the previous Monte Carlo simulations and change n
s <- replicate(10^5,{
x <- sample(c(-1, 1), size = n, replace = TRUE, prob = c(9/19, 10/19))
sum(x)
})
pnorm(s, mean=mean(s), sd = sqrt((s-mean(s))^2))
s <- replicate(10^3,{
x <- sample(c(0, 1), size = 5*10^5, replace = TRUE, prob = c(1 - 10^-6, 10^-6))
sum(x)
})
plot(table(s))
sapply(0:4, function(x) mean(s==k))
library(tidyverse)
url <- "https://web.archive.org/web/20161108012231/https://www.realclearpolitics.com/epolls/2016/president/us/general_election_trump_vs_clinton-5491.html"
library(rvest)
tab <- read_html(url) |> html_node("table") |> html_table()
tab <- tab |> mutate(Poll = stringr::str_remove(Poll, "\\/.*")) |>
mutate(Poll = case_when(
Poll == "BloombergBloomberg" ~ "Bloomberg",
Poll == "FOX NewsFOX News" ~ "FOX News",
Poll == "MonmouthMonmouth"  ~ "Monmouth",
Poll == "CBS NewsCBS News" ~ "CBS News",
TRUE ~ Poll))
names(tab) <- stringr::str_remove_all(names(tab), "\\s(.*)")
knitr::kable(tab, "html") |>
kableExtra::kable_styling(bootstrap_options = "striped", full_width = FALSE)
set.seed(1)
library(tidyverse)
library(dslabs)
take_poll(25)
?take_poll
N <- 10^seq(1, 5, len = 100)
map_df(c(0.1, 0.25, 0.5), function(p) data.frame(N = N, SE = sqrt(p*(1 - p)/N), p = as.character(p)))  |>
ggplot(aes(N, SE, color = p)) +
geom_line() +
scale_x_continuous(breaks = c(10, 100, 1000, 10000), trans = "log10", labels = scales::comma) +
geom_hline(yintercept = 0.01, lty = 2)
x_hat <- 0.52
se <- sqrt(x_hat*(1 - x_hat)/25)
se
pnorm(0.01/se) - pnorm(-0.01/se)
1.96*se
p <- 0.45
N <- 1000
x <- sample(c(0, 1), size = N, replace = TRUE, prob = c(1 - p, p))
x_hat <- mean(x)
B <- 10000
x_hat <- replicate(B, {
x <- sample(c(0, 1), size = N, replace = TRUE, prob = c(1 - p, p))
mean(x)
})
mean(x_hat)
sd(x_hat)
library(tidyverse)
library(gridExtra)
p1 <- data.frame(x_hat=x_hat) |>
ggplot(aes(x_hat)) +
geom_histogram(binwidth = 0.005, color="black")
p2 <-  data.frame(x_hat=x_hat) |>
ggplot(aes(sample=x_hat)) +
stat_qq(dparams = list(mean=mean(x_hat), sd=sd(x_hat))) +
geom_abline() +
ylab("x_hat") +
xlab("Theoretical normal")
grid.arrange(p1,p2, nrow=1)
p <- 0.45
N <- 1000
x <- sample(c(0, 1), size = N, replace = TRUE, prob = c(1 - p, p))
x_hat <- mean(x)
se_hat <- sqrt(x_hat * (1 - x_hat) / N)
c(x_hat - 1.96 * se_hat, x_hat + 1.96 * se_hat)
x <- sample(c(0, 1), size = N, replace = TRUE, prob = c(1 - p, p))
x_hat <- mean(x)
se_hat <- sqrt(x_hat * (1 - x_hat) / N)
c(x_hat - 1.96 * se_hat, x_hat + 1.96 * se_hat)
z <- qnorm(0.995)
z
pnorm(z) - pnorm(-z)
qnorm(0.975)
N <- 1000
B <- 10000
inside <- replicate(B, {
x <- sample(c(0, 1), size = N, replace = TRUE, prob = c(1 - p, p))
x_hat <- mean(x)
se_hat <- sqrt(x_hat * (1 - x_hat) / N)
between(p, x_hat - 1.96 * se_hat, x_hat + 1.96 * se_hat)
})
mean(inside)
set.seed(1)
tab <- replicate(100, {
x <- sample(c(0,1), size = N, replace = TRUE, prob = c(1-p, p))
x_hat <- mean(x)
se_hat <- sqrt(x_hat * (1 - x_hat) / N)
hit <- between(p, x_hat - 1.96 * se_hat, x_hat + 1.96 * se_hat)
c(x_hat, x_hat - 1.96 * se_hat, x_hat + 2 * se_hat, hit)
})
tab <- data.frame(poll=1:ncol(tab), t(tab))
names(tab)<-c("poll", "estimate", "low", "high", "hit")
tab <- mutate(tab, p_inside = ifelse(hit, "Yes", "No") )
ggplot(tab, aes(poll, estimate, ymin=low, ymax=high, col = p_inside)) +
geom_point()+
geom_errorbar() +
coord_flip() +
geom_hline(yintercept = p)
sample(c(-1,17), size =1, prob = c(18/19,1/19))
-1*18/19+17*18/19
sqrt(1*18/19+(17*18)^2/19 - (-1*18/19+17*18/19)^2)
18*sqrt(18/19*1/19)
x <- sample(c(-1,17), size =1000, prob = c(18/19,1/19))
x <- sample(c(-1,17), size =1000, prob = c(18/19,1/19),replace = T)
n = 1000
x <- sample(c(-1,17), size =n, prob = c(18/19,1/19),replace = T)
n*1/19
p = 1/19
n*p
sqrt(n)*sqrt(18*p(1-p))
p = 1/19
n*p
sqrt(n)*sqrt(18*p(1-p))
sqrt(n)*sqrt(18*p*(1-p))
p = 1/19
miu = n*p
se = sqrt(n)*sqrt(18*p*(1-p))
pnorm(-miu/se)
library(dslabs)
heights |> group_by(sex) |>
reframe(qs = quantile(height,seq(1,9,2)/10))
quantile(height,seq(1,9,2)/10)
library(dslabs)
qs <- seq(10,90,20)
heights |> group_by(sex) |>
reframe(quantile = paste0(qs, "%"), value = quantile(height, qs/100)) |>
pivot_wider(names_from = sex) |>
rename(female_percentiles = Female, male_percentiles = Male)
library(dslabs)
qs <- seq(10,90,20)
heights |> group_by(sex) |>
reframe(quantile = paste0(qs, "%"), value = quantile(height, qs/100)) |>
pivot_wider(names_from = sex)
library(dslabs)
qs <- seq(10,90,20)
heights |> group_by(sex) |>
reframe(quantile = paste0(qs, "%"), value = quantile(height, qs/100))
?reframe
?quantile
quantile(heights$height)
library(dslabs)
qs <- seq(10,90,20)
heights |> group_by(sex) |>
reframe(quantile = paste0(qs, "%"), value = quantile(height, qs/100)) |>
pivot_wider(names_from = sex) |>
rename(female_percentiles = Female, male_percentiles = Male)
library(tidyverse)
library(dslabs)
ds_theme_set()
tab <- gapminder |> filter(year == 2010) |> group_by(continent) |> select(continent, population)
tab |> ggplot(aes(x = continent, y = population/10^6)) +
geom_boxplot() +
scale_y_continuous(trans = "log10", breaks = c(1,10,100,1000)) + ylab("Population in millions")
tab
gapminder |> filter(year == 2010) |> group_by(continent)
library(tidyverse)
library(dslabs)
ds_theme_set()
tab <- gapminder |> filter(year == 2010) |> group_by(continent) |> select(continent, population)
tab1 = gapminder |> filter(year == 2010) |> group_by(continent) |> summarise(population = unique(population)[[1]]) |> select(continent, population)
tab == tab1
library(tidyverse)
library(dslabs)
ds_theme_set()
tab <- gapminder |> filter(year == 2010) |> group_by(continent) |> select(continent, population)
tab1 = gapminder |> filter(year == 2010) |> group_by(continent) |> summarise(population = unique(population)[[1]]) |> select(continent, population)
identical(tab,tab1)
tab |> ggplot(aes(x = continent, y = population/10^6)) +
geom_boxplot() +
scale_y_continuous(trans = "log10", breaks = c(1,10,100,1000)) + ylab("Population in millions")
tab1
tab
library(tidyverse)
library(dslabs)
ds_theme_set()
tab <- gapminder |> filter(year == 2010) |> group_by(continent) |> select(continent, population)
tab1 = gapminder |> filter(year == 2010) |> group_by(continent) |> mutate(population = unique(population)[[1]]) |> select(continent, population)
identical(tab,tab1)
tab |> ggplot(aes(x = continent, y = population/10^6)) +
geom_boxplot() +
scale_y_continuous(trans = "log10", breaks = c(1,10,100,1000)) + ylab("Population in millions")
tab
gapminder |> filter(year == 2010)
gapminder |> filter(year == 2010) |> select(continent,population)
gapminder |> filter(year == 2010) |> select(continent,population) |> head()
tab
library(tidyverse)
library(dslabs)
ds_theme_set()
tab <- gapminder |> filter(year == 2010) |> group_by(continent) |> select(continent, population)
tab |> ggplot(aes(x = continent, y = population/10^6)) +
geom_boxplot() +
scale_y_continuous(trans = "log10", breaks = c(1,10,100,1000)) + ylab("Population in millions")
tab |> filter(continent=='Europe')
tab |> filter(continent=='Europe') |> mutate(yes = if(population>14000000,1,0))
tab |> filter(continent=='Europe') |> mutate(yes = ifelse(population>14000000,1,0))
tab |> filter(continent=='Europe') |> mutate(yes = ifelse(population>14000000,1,0)) |> sum(yes)
check = tab |> filter(continent=='Europe') |> mutate(yes = ifelse(population>14000000,1,0))
sum(check$yes)/length(check)
check = tab |> filter(continent=='Europe') |> mutate(yes = ifelse(population>14000000,1,0))
sum(check$yes)/dim(check)[1]
check = tab |> filter(continent=='Europe') |> mutate(yes = ifelse(population<14000000,1,0))
sum(check$yes)/dim(check)[1]
tab|>mutate(log = log10(population))
tab|>mutate(log = log10(population)) |> ggplot(aes(x = continent, y = log)) +
geom_boxplot() +
scale_y_continuous(trans = "log10", breaks = c(1,10,100,1000)) + ylab("Population in millions")
x>=69 & x<=72
sum(x>=69 & x<=72)/length(x)
sum(x>69 & x<=72)/length(x)
mean(x>69 & x<=72)
library(dslabs)
x <- heights$height[heights$sex=="Male"]
x
x>69 & x<=72
(x>69 & x<=72)
sum(x>69 & x<=72)
mean(x>69 & x<=72)
if (exists("murders")) rm(murders)
library(dslabs)
murders$rate <- with(murders, total/population*10^5)
murders[murders$rate < 1,]
seq(6:55,4/7)
seq(from=6, to=55,4/7)
rbinom(10, 1, 10/19)
temp <- c(35, 88, 42, 84, 81, 30)
city <- c("Beijing", "Lagos", "Paris", "Rio de Janeiro",
"San Juan", "Toronto")
city_temps <- data.frame(name = city, temperature = temp)
city_temps
city_temps |> mutate(celcius = 5/9*(temp-32))
n = 5
c(1:n)^2
n = 5
(1/c(1:n))^2
n = c(1:200)
plot(n,(1/c(1:n))^2)
n = c(1:200)
plot(n,(1/(1/n)^2)
n = c(1:200)
plot(n,(1/n^(-2))
n = c(1:200)
plot(x=n,y=(1/n^(-2))
(1/n^(-2)
)
n = c(1:200)
plot(x=n,y=n^(-2))
pi^2/6
n = c(1:200)
n^(-2)
n = c(1:200)
sumsum(n^(-2))
n = c(1:200)
cumsum(n^(-2))
n = c(1:200)
plot(n,cumsum(n^(-2)))
n = c(1:200)
plot(n,cumsum(n^(-2)))
vlines(pi^2/6)
n = c(1:200)
plot(n,cumsum(n^(-2)))
vline(pi^2/6)
n = c(1:200)
plot(n,cumsum(n^(-2)))
abline(pi^2/6)
n = c(1:200)
plot(n,cumsum(n^(-2)))
abline(h=pi^2/6)
n = c(1:200)
plot(n,cumsum(n^(-2)))
abline(h=pi^2/6,col='red')
state.abb
state.abb %in% c('MA', 'ME', 'MI', 'MO', 'MU')
!state.abb %in% c('MA', 'ME', 'MI', 'MO', 'MU')
setwd('/Users/shaochong/Desktop/BST210/210Project')
dat = read_csv('test.csv')
setwd('/Users/shaochong/Desktop/BST210/210Project')
dat = read_csv('test.csv')
head(dat)
setwd('/Users/shaochong/Desktop/BST210/210Project')
dat = read_csv('cardio_data_processed.csv')
head(dat)
